# frozen_string_literal: true

module Staffers::CareCases::Chats
  class ChatActionsComponent < ViewComponent::Base
    include Turbo::FramesHelper

    attr_reader :channel, :user, :membership, :safety_flag, :member

    def initialize(channel:, user:, membership:, safety_flag:, member:, account: nil, staffer: nil)
      @channel = channel
      @user = user
      @membership = membership
      @safety_flag = safety_flag
      @member = member
      @account = account
      @staffer = staffer
    end

    def account
      @account || care_case.account
    end

    def care_case
      helpers.current_care_case
    end

    def staffer
      @staffer || helpers.current_staffer
    end

    def conversation
      Chat::MemberSupportConversation.opened_for_channel(channel)
    end
  end
end
