<div id="chat_actions_header_contents" data-turbo="true">
  <div class="row mb-lg-3">
    <%= render Staffers::CareCases::Chats::StatusComponent.new(channel: channel) %>
  </div>

  <div class="row">

    <div class="col">
      <% if channel.chat_type_member_support? %>
        <% if conversation&.open? && conversation&.claimed_by?(staffer) %>
          <div class="float-left" id="close-conversation-button">
            <%= button_to "Mark as closed",
                  member_support_read_conversations_path(sendbird_chat_channel_id: channel.id),
                  class: "prism-button-danger",
                  data: {turbo_frame: "_top"} %>
          </div>
        <% end %>
      <% end %>

      <div class="flex justify-end">
        <% if SupplementalChatCoachPolicy.new(staffer).create? %>
          <div data-controller="modals events">
            <%= turbo_frame_tag :supplemental_coach_form do %>
              <%= render Staffers::Accounts::Chats::SupplementalCoachFormComponent.new(
                    account: account,
                    member: member,
                    chat_type: channel.chat_type
                  ) %>
          <% end %>
          </div>
        <% end %>

        <% if ChatMarkerPolicy.new(staffer).create? %>
          <div class="mr-2">
            <%= render(Staffers::CoachWorkflows::FlagFormComponent.new(
                  account: account,
                  member: member,
                  sendbird_user: user,
                  sendbird_chat_channel: channel,
                  flag: safety_flag
                )) %>
          </div>
          <div class="mr-2">
            <%= render(Staffers::CoachWorkflows::StarFormComponent.new(
                  starred: membership.starred?,
                  form_path: coach_workflows_sendbird_chat_channel_membership_path(membership),
                  starred_component: Staffers::CoachWorkflows::StarredButtonComponent.new,
                  unstarred_component: Staffers::CoachWorkflows::UnstarredButtonComponent.new
                )) %>
          </div>
        <% end %>

        <%= button_to "Mark as unread",
              account_member_chat_unread_messages_path(account, member, channel, sendbird_user_id: user),
              id: "messages-unread-button",
              class: "prism-button-primary float-right" %>
      </div>
    </div>
  </div>
</div>
