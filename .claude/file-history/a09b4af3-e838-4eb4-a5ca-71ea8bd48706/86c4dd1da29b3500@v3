<% if unstarring_on_starred_tab? %>
  <!-- Put a stimulus controller on chat conversation to remove it after 3 seconds if the chat is being unstarred from the starred tab -->
  <%= turbo_stream.update sendbird_chat_channel_membership do %>
    <div data-controller="delayed-removal">
      <%= render(
            Staffers::CoachWorkflows::ChatChannelComponent.new(
              accessible_staffer_channel: Chat::AccessibleStafferChannel.from_membership(sendbird_chat_channel_membership),
              current_staffer: current_staffer
            )
          ) %>
    </div>
  <% end %>

  <!-- Show a flash message to help Coach get back to chat that is removed from DOM if they misclicked -->
  <%= turbo_stream.append "flash" do %>
    <%= render(Staffers::FlashMessageComponent.new(type: "primary")) do %>
      <%= link_to "Chat with #{member&.full_name}", accessible_staffer_channel.path %> has been unstarred.
    <% end %>
  <% end %>
<% else %>
  <%= turbo_stream.update sendbird_chat_channel_membership do %>
    <%= render(
          Staffers::CoachWorkflows::ChatChannelComponent.new(
            accessible_staffer_channel: Chat::AccessibleStafferChannel.from_membership(sendbird_chat_channel_membership),
            current_staffer: current_staffer
          )
        ) %>
  <% end %>
<% end %>
